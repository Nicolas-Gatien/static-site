<!DOCTYPE html>
<html>
<head>
    <title>Plotting Raw Voltage Traces</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap');
    </style>
</head>

<body>
    <div id="left" class="side"></div>

    <div id="content">
        <div class="heading-div">
            <button class="back-button" onclick="history.back()">Back</button>
            <h1>Plotting Raw Voltage Traces</h1>
        </div>
        

<div class="article-meta">
    
    <time datetime="2025-07-07" class="article-date">2025-07-07</time>
    

    
    <span class="article-author">• Nicolas Gatien</span>
    

    
    <span class="article-type">• flow</span>
    

    
</div>

<div class="article-content">
    <p>Today I plotted the raw voltage values from the same <a href="https://datadryad.org/dataset/doi:10.25349/D9031Z">dataset</a> I've been working with for the past week. Here's the result:<br />
<img src="/static/imgs/organoid-raw-voltage.png" alt="organoid-raw-voltage.png"><br></p>
<p>I did this just by loading the <code>h5</code> file and getting the <code>sig</code> array:</p>
<div class="highlight"><pre><span></span><code><span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mea/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">]</span>
</code></pre></div>

<p>From there, I would trim down the <code>sig</code> data with the number of channels I want to plot, and the number of datapoints as well. The graph above is 1.1 million datapoints across 20 channels.</p>
<div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">sig</span><span class="p">[:</span><span class="n">num_of_channels</span><span class="p">,</span> <span class="p">:</span><span class="mi">1100000</span><span class="p">]</span>
</code></pre></div>

<p>Then, I get the min and max values from the data using <code>numpy</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">data_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">data_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

<p>And then I plot the data using <code>matplotlib</code>. </p>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num_of_channels</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">channel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">data_min</span><span class="p">,</span> <span class="n">data_max</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p>This is actually the same data I used to generate the following image:<br />
<img src="/static/imgs/7month_2953_diff_animation_1000_0.gif" alt="7month_2953_diff_animation_1000_0.gif"><br></p>
<p>The next step is to clean up the data and perform spike sorting so that I can see when the neurons are actually spiking. The end goal is create a raster plot like the one displayed in the <a href="https://www.nature.com/articles/s41467-022-32115-4">paper</a> associated with this dataset.</p>
<p><img src="/static/imgs/raster-plot.png" alt="raster-plot.png"><br><br />
Each row represents a neuron (not a channel) and each blue dot represents a neuron spiking. To achieve this I need to use a spike sorting algorithm, and I haven't figured those out yet.</p>
<p>Additionally, I'm sure there's some pre-processing I also need to do. When I look at the current voltage graph, it reminds me of the first image I produced while <a href="/graphing-eeg-data" class="internal">graphing-eeg-data</a>. It's a little messy and all over the place.</p>
</div>


    </div>

    <div id="right" class="side"></div>

    <script src="../app.js"></script>
</body>
</html>